{"version":3,"file":"ChartContainer.js","sources":["../../src/internal/ChartContainer.tsx"],"sourcesContent":["import { ThemingParameters } from '@ui5/webcomponents-react-base/dist/ThemingParameters';\nimport { usePassThroughHtmlProps } from '@ui5/webcomponents-react-base/dist/usePassThroughHtmlProps';\nimport { Label } from '@ui5/webcomponents-react/dist/Label';\nimport { Loader } from '@ui5/webcomponents-react/dist/Loader';\nimport { CommonProps } from '@ui5/webcomponents-react/interfaces/CommonProps';\nimport React, { ComponentType, CSSProperties, FC, forwardRef, ReactElement, ReactNode, Ref, useMemo } from 'react';\nimport { createUseStyles } from 'react-jss';\nimport { ResponsiveContainer } from 'recharts';\n\nexport interface ContainerProps extends CommonProps {\n  children: ReactElement;\n  Placeholder?: ComponentType;\n  dataset: unknown[];\n  loading?: boolean;\n  resizeDebounce: number;\n}\n\n// eslint-disable-next-line no-underscore-dangle\nconst __testingProps__: any = {};\n\nif (process.env.NODE_ENV === 'test') {\n  __testingProps__.width = 400;\n  __testingProps__.height = 400;\n}\n\nconst loaderStyles: CSSProperties = {\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  right: 0\n};\n\nconst chartContainerStyles = {\n  '@global': {\n    '.has-click-handler': {\n      '& .recharts-pie-sector, .recharts-bar-rectangles, .recharts-active-dot, .recharts-area-dot': {\n        cursor: 'pointer'\n      }\n    }\n  }\n};\n\nconst useStyles = createUseStyles(chartContainerStyles, { name: 'ChartContainer' });\n\nclass ErrorBoundary extends React.Component<{ children: ReactNode }, { errorCount: number }> {\n  state = {\n    errorCount: 0\n  };\n\n  componentDidCatch() {\n    if (this.state.errorCount < 3) {\n      this.setState((old) => ({ ...old, errorCount: old.errorCount + 1 }));\n    }\n  }\n\n  render() {\n    if (this.state.errorCount >= 3) {\n      return <Label>Sorry, something went wrong while rendering this chart!</Label>;\n    }\n    return this.props.children;\n  }\n}\n\nconst ChartContainer: FC<ContainerProps> = forwardRef((props: ContainerProps, ref: Ref<any>) => {\n  const { Placeholder, loading = false, dataset, style, className, tooltip, slot, children, resizeDebounce } = props;\n  useStyles();\n\n  const internalStyles: CSSProperties = useMemo(() => {\n    return {\n      fontSize: ThemingParameters.sapFontSmallSize,\n      color: ThemingParameters.sapTextColor,\n      fontFamily: ThemingParameters.sapFontFamily,\n      width: '100%',\n      height: '400px',\n      position: 'relative',\n      ...(style ?? {})\n    };\n  }, [style]);\n\n  const passThroughProps = usePassThroughHtmlProps(props);\n\n  return (\n    <div ref={ref} style={internalStyles} className={className} title={tooltip} slot={slot} {...passThroughProps}>\n      {dataset?.length > 0 ? (\n        <>\n          {loading && <Loader style={loaderStyles} />}\n          <ErrorBoundary>\n            <ResponsiveContainer debounce={resizeDebounce} {...__testingProps__}>\n              {children}\n            </ResponsiveContainer>\n          </ErrorBoundary>\n        </>\n      ) : (\n        <Placeholder />\n      )}\n    </div>\n  );\n});\n\nChartContainer.displayName = 'ChartContainer';\n\nexport { ChartContainer };\n"],"names":["__testingProps__","process","env","NODE_ENV","width","height","loaderStyles","position","top","left","right","chartContainerStyles","cursor","useStyles","createUseStyles","name","ErrorBoundary","errorCount","state","setState","old","props","children","React","Component","ChartContainer","forwardRef","ref","Placeholder","loading","dataset","style","className","tooltip","slot","resizeDebounce","internalStyles","useMemo","fontSize","ThemingParameters","sapFontSmallSize","color","sapTextColor","fontFamily","sapFontFamily","passThroughProps","usePassThroughHtmlProps","length","displayName"],"mappings":"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"}